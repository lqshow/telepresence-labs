
# Overview

XDP 平台已经全面微服务化，且完全拥抱 Kubernetes，通过 Kubernetes 完成日常的开发，测试以及生产发布。

虽然 Kubernetes 解决了微服务运行时的环境问题，但是对于开发者来说，在微服务开发过程中就不是那么的友好了，而且在本地开发的效率也不是那么的理想，甚至可以说是很痛苦。


## 微服务开发痛点

众所周知微服务架构很难，不好搞，这里不进行深入微服务架构的痛点，只说开发者在微服务开发过程中碰到的微服务架构下的开发环境问题。

现在 XDP 平台具不完全统计已经有几十个服务了，这还是在不包括基础设施服务的前提下。假如你作为 XDP 团队的一个新人，接到一个需求，在某个服务下增加一个功能或者是要修复一个 bug，你接下来准备怎么做？

打算将几十个服务都在本机跑起来吗？且不说你不知道 XDP 平台到底有多少个服务，光是想想配置这一整套环境都头大，再说你的机器是否有足够的资源能撑的起 XDP 平台的运行。

## 开发现状

### local + remote

利用 Kubernetes 原生的特性 port-forward 命令或者 [kubefwd](https://github.com/txn2/kubefwd) 工具，将 Kubernetes 集群中的服务转发到本地，然后通过 local 的方式访问 Kubernetes 集群中的服务，这种方式可以解决开发过程中的一些联调问题。

**痛点**

1. 需要转发的服务配置不可控，且取决于团队成员是否都有 Kubernetes 基础，是否对平台的微服务架构都比较了解。
2. 不稳定，时不时需要重新做服务映射，特别是在家里用 VPN 连入公司内网情况下
3. 单向调用，只能从本地向集群发请求，集群内的流量请求无法劫持转发到本地

### remote

利用内网自动化流水性的的方式，将代码发布到内网测试环境，即将服务持续的部署到内网 Kubernetes 测试环境中进行联调测试，以便提前发现问题。

**痛点**

1. 虽然该过程可以自动完成，但是每次调试至少需要经历以下步骤（git commit -> docker build -> deploy to k8s cluster），耗时比较长，效率低下。
2. 一般每个团队都是共享内网开发测试环境的，这种 remote debug 方式会影响到团队内的其他成员的开发进度。

### pure offline

不建议你这么做，首先你需要利用比如 docker-comose 编排工具或者是 [Kind](https://github.com/kubernetes-sigs/kind) 在本地部署好环境，且不说你本地开发机器有没那么大的资源，同时维护两套部署配置也是一个挺费劲的事。


## Telepresence

